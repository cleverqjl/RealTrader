# CTA跨品种套利策略价差构建思路

## 1. 基本概念

CTA的跨品种套利是指对两个（或两组）存在强相关性的期货品种（或品种组）进行套利交易，即买入一个（或一组）品种（或品种组）的同时，等市值卖出另一个（或一组）品种（或品种组）。为了控制风险，且更好地实现价差回归，通常这两个（或两组）的历史价格数据存在统计上的相关性，且一般要求相关性高于0.8（甚至更高）。

如果他们之间存在基本面的逻辑支撑，比如产业链上下游关系或者替代品、互补品关系，那么这种跨品种套利属于更优先考虑的。例如焦炭、铁矿石和螺纹钢的套利。

螺纹钢期货价格 = 1.6 × 铁矿石期货价格 + 0.5 × 焦炭期货价格 + 其他成本（东方证券《衍生品系列研究之五-商品期货套利策略实证》）

这个等式只是理论的，实际上三者的期货价格随时在波动，所以我们可以构建一个指标：
钢厂利润 = 1 × 螺纹钢指数合约价格 - 1.6 × 铁矿石指数合约价格 - 0.5 × 焦炭指数合约价格 - 其他成本

当这个钢厂利润（即价差）高于某个阈值时，就做空钢厂利润，否则做多钢厂利润。

## 2. 风险认知

交易CTA跨品种套利策略时，一定要充分认知里面的风险：

- 严格意义的套利（无风险套利）下，价差一定会回归，例如：
  - 股指期货期现套利（股指期货升水时，买入ETF，卖出对应股指期货）
  - 商品期货的期现套利（必须有满足交割的现货货源或者有现货交易的需求）

- CTA跨品种套利策略基本上都属于统计套利类策略。统计套利是将套利建立在对历史数据进行统计分析的基础之上，估计相关变量的概率分布，并针对价差建立相应模型，以指导套利交易。

- 相比于无风险套利，统计套利增加了一些风险，但是由此可获得的套利机会将数倍于无风险套利。

## 3. 价差构建方法

### 3.1 常规构建思路

以RB和HC套利为例，主要有以下三种方式：

1. 方式一：RB价格-HC价格，超过一定阈值（例如2倍历史价差的标准差），做多某个品种的同时，做空等市值的另一个品种。

2. 方式二：LOG(RB价格)-LOG（HC价格），超过一定阈值（例如2倍历史价差的标准差），做多某个品种的同时，做空等市值的另一个品种。LOG价差的本质是价比。

3. 方式三：RB价格=b×HC价格+e，交易对象为RB和b×HC（即1倍RB，对应b倍HC)，价差为e。采用这种回归方式构建价差的优势是考虑了两个标的（例如RB和HC）的价格大小以及波动性大小。

### 3.2 多品种组合套利构建思路

以PP+MA+BU对V+L+TA日线套利为例，其绩效：
- 夏普：2.5
- 单倍年化：22%
- 最大回撤：5.1%

#### 构建思路一：去量纲化方法

```matlab
for i=Start:End   
    for j=1:4   
        DATA{1}(i,j)=PP(i,j)/mean(PP(i-4:i,j))+MA(i,j)/mean(MA(i-4:i,j))+BU(i,j)/mean(BU(i-4:i,j));    
        DATA{2}(i,j)=V(i,j)/mean(V(i-4:i,j))+L(i,j)/mean(L(i-4:i,j))+TA(i,j)/mean(TA(i-4:i,j));      
    end
end

OPEN=DATA{1}(:,1)-DATA{2}(:,1);  % 开盘价的价差
HIGH=DATA{1}(:,2)-DATA{2}(:,2);  % 最高价的价差
LOW=DATA{1}(:,3)-DATA{2}(:,3);   % 最低价的价差
CLOSE=DATA{1}(:,4)-DATA{2}(:,4); % 收盘价的价差
```

#### 构建思路二：收益率复利方法

```matlab
DATA{1}(Start-1,1:4)=1;
DATA{2}(Start-1,1:4)=1;
for i=Start:End    
    for j=1:4    
        DATA{1}(i,j)=DATA{1}(i-1,j)*(1+(PP(i,j)/PP(i-1,j)+MA(i,j)/MA(i-1,j)+BU(i,j)/BU(i-1,j)-3)/3);     
        DATA{2}(i,j)=DATA{2}(i-1,j)*(1+(V(i,j)/V(i-1,j)+L(i,j)/L(i-1,j)+TA(i,j)/TA(i-1,j)-3)/3);     
    end
end

OPEN=DATA{1}(:,1)-DATA{2}(:,1);  % 开盘价的价差
HIGH=DATA{1}(:,2)-DATA{2}(:,2);  % 最高价的价差
LOW=DATA{1}(:,3)-DATA{2}(:,3);   % 最低价的价差
CLOSE=DATA{1}(:,4)-DATA{2}(:,4); % 收盘价的价差
```

#### 构建思路三：因子值构建方法

```matlab
% 分别计算同一因子在每个品种上面的因子值
temp1=skewness((PP(i,4)-PP(i-1,4))/PP_KDJ(i,4));  
temp2=skewness((MA(i,4)-MA(i-1,4))/MA_KDJ(i,4));
temp3=skewness((BU(i,4)-BU(i-1,4))/BU_KDJ(i,4));
temp4=skewness((V(i,4)-V(i-1,4))/V_KDJ(i,4));
temp5=skewness((L(i,4)-L(i-1,4))/L_KDJ(i,4));
temp6=skewness((TA(i,4)-TA(i-1,4))/TA_KDJ(i,4));

% 构建价差因子
signal(i)=temp1+temp2+temp3-temp4-temp5-temp6;
```

## 4. 总结

以上为本策略使用到的价差和因子的构建思路。多样化的构建思路是非常重要的，因为只有多样化、低相关性才能更好地实现组合效应，提升策略绩效。总之一句话，不管黑猫白猫，抓得住老鼠的才是好猫，实践出真知！欢迎大家批评指正！